#!/bin/bash

jq -c '[ .features[] | select(.properties.feedType == "warning") | select(.properties.category1 != "Advice") | { id: (.properties.id|tonumber), title: (.properties.sourceTitle | ascii_upcase), location: .properties.location, category: .properties.cap.category, event: (.properties.cap.event | ascii_upcase), senderAgency: .properties.cap.senderName, action: (.properties.action | ascii_upcase), urgency: .properties.cap.urgency, severity: .properties.cap.severity, certainty: .properties.cap.certainty, text: ((.properties.text | split("moreinfo\n")[0]) + "moreinfo"), url: ("https://emergency.vic.gov.au/respond/#!/warning/" + .properties.sourceId + "/moreinfo"), created: .properties.created, updated: .properties.updated } ]' $(pwd)/response.json | jq '(.[].text + "\n\n#VicFires" + "\n\n-----------------\n")' | jq -r . > $(pwd)/output.txt